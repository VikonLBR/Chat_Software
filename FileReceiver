package filemanager;
import java.io.BufferedInputStream;
import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.ServerSocket;
import java.net.Socket;

import ipaddress.Sop;
public class Receiver {

	public static void main(String[] args) throws IOException {

		ServerSocket ss=new ServerSocket(2333);
		Socket s=ss.accept();
		
		InputStream is=s.getInputStream();
		OutputStream os=s.getOutputStream();
		BufferedInputStream bis=new BufferedInputStream(is);
		BufferedOutputStream bos=new BufferedOutputStream(os);
		
		int length;
		byte[] bread=new byte[1024*10];
		byte[] bname=new byte[1024];
		length=bis.read(bname);
		String str=new String(bname,10,length);
		Sop.print(str);
		String name="d:\\copy_"+str.trim();
		Sop.print(name);
		File file=new File(name);
		if(!file.exists())
			file.createNewFile();

		bos.write("namereceived".getBytes());
		bos.flush();
			
		
		
		BufferedOutputStream bosfile=new BufferedOutputStream(new FileOutputStream(file));
		
		while(true){
			length=bis.read(bread);

			if(length!=-1){
				bosfile.write(bread, 0, length);
				bosfile.flush();
				bos.write("re".getBytes());
				bos.flush();	
			}	
			else if(length==-1)
				break;
		}		

		ss.close();
		bosfile.close();
		Sop.print("Link ends");
}
		
}

